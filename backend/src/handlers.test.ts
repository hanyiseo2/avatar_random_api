import app from "./app";
import request from "supertest";

describe("GET /avatar", () => {
  it("must response with a random image", async () => {
    const response = await request(app).get("/avatar");
    expect(response.status).toBe(200);
  });

  it("must response with seed 'hanyi'", async () => {
    const response = await request(app).get("/avatar?seed=hanyi");
    expect(response.status).toBe(200);
    expect(response.text).toEqual(
      '<svg width="200" height="200" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="200" height="200" fill="#BA9E73"/><path d="M107.243 35.1333C104.576 23.4667 117.221 14.514 130.243 20.66C160.909 35.1333 142.667 55.3333 131.333 54C120 52.6667 109.909 46.8 107.243 35.1333Z" fill="#E0713F"/><path d="M118.333 37C118.333 37 141 51.6667 146.667 43.6667C147.251 47.0073 144.563 56.4433 140.333 56.3333C127.682 56.004 118.333 37 118.333 37Z" fill="#E0713F"/><path d="M114.667 108.667C100.345 115.547 98.2553 115.179 66.6666 89.3332C19 50.3333 64 14.6666 112.333 33.6666C164.667 56.6666 147.134 93.0712 114.667 108.667Z" fill="#E0713F"/><path d="M161.333 162C166.222 171.333 168.667 205.333 168.667 205.333H31.3333C31.3333 205.333 33.7779 171.333 38.6666 162C45.9999 148 99.9999 130 99.9999 130C99.9999 130 154 148 161.333 162Z" fill="#DDA4A4"/><path d="M116 134.667C116 134.667 107.489 139.333 99.66 139.333C91.8307 139.333 84 134.667 84 134.667V120C82.3157 120.266 80.6094 120.368 78.9054 120.303C62.9134 120.301 56.8834 97.0073 60 68.6666C62 68.6666 66.6667 68.6666 73.3334 59.3333C71.6667 72.3333 91 70.3333 98.3334 60C94.6667 72.3333 104.333 80.6666 112.667 75.6666C129.007 65.862 132.681 95.7506 116 96V134.667Z" fill="#322614"/></svg>'
    );
  });

  it("must response with seed 'claire'", async () => {
    const response = await request(app).get("/avatar?seed=claire");
    expect(response.status).toBe(200);
    expect(response.text).toEqual(
      '<svg width="200" height="200" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="200" height="200" fill="#FFC9B3"/><path d="M30 159.539C23.6533 172.443 20 202.205 20 202.205H180C180 202.205 176.345 172.44 170 159.539C163.655 146.637 126.6 134.671 126.6 134.671C119.458 149.333 80.2613 149.333 73.4193 134.667C73.4193 134.667 36.3467 146.634 30 159.539Z" fill="#1D0024"/><path d="M102.667 185.333C102.667 184.806 102.51 184.29 102.217 183.852C101.924 183.413 101.508 183.071 101.021 182.87C100.533 182.668 99.9971 182.615 99.4798 182.718C98.9625 182.821 98.4873 183.075 98.1144 183.448C97.7415 183.821 97.4875 184.296 97.3846 184.813C97.2817 185.33 97.3345 185.867 97.5363 186.354C97.7382 186.841 98.08 187.258 98.5185 187.551C98.957 187.844 99.4726 188 100 188C100.707 188 101.386 187.719 101.886 187.219C102.386 186.719 102.667 186.041 102.667 185.333ZM102.667 172C102.667 171.473 102.51 170.957 102.217 170.518C101.924 170.08 101.508 169.738 101.021 169.536C100.533 169.334 99.9971 169.282 99.4798 169.385C98.9625 169.487 98.4873 169.741 98.1144 170.114C97.7415 170.487 97.4875 170.962 97.3846 171.48C97.2817 171.997 97.3345 172.533 97.5363 173.02C97.7382 173.508 98.08 173.924 98.5185 174.217C98.957 174.51 99.4726 174.667 100 174.667C100.707 174.667 101.386 174.386 101.886 173.886C102.386 173.386 102.667 172.707 102.667 172ZM102.667 158.667C102.667 158.139 102.51 157.624 102.217 157.185C101.924 156.747 101.508 156.405 101.021 156.203C100.533 156.001 99.9971 155.948 99.4798 156.051C98.9625 156.154 98.4873 156.408 98.1144 156.781C97.7415 157.154 97.4875 157.629 97.3846 158.146C97.2817 158.664 97.3345 159.2 97.5363 159.687C97.7382 160.174 98.08 160.591 98.5185 160.884C98.957 161.177 99.4726 161.333 100 161.333C100.707 161.333 101.386 161.052 101.886 160.552C102.386 160.052 102.667 159.374 102.667 158.667V158.667Z" fill="white"/><path d="M79.3333 116V124C79.3333 134.667 64 139.333 64 139.333C64 139.333 81.6667 152.667 100 152.667C118.333 152.667 136 139.333 136 139.333C136 139.333 120.546 134.667 120.667 124C120.787 113.333 120.707 107.067 120.787 88.7919C130.342 76.4073 129.729 68.0953 124.504 62.2499C107 42.6666 59.3333 49.3333 59.3333 49.3333C59.3333 49.3333 54.8853 97.3286 65 111.333C69.3333 117.333 79.3333 116 79.3333 116Z" fill="#F7B186"/><path d="M112.563 68.8059C114.683 66.9852 117.259 65.7592 120.901 67.6512C129.533 72.1332 123 89.3332 115.333 89.3332C113.333 89.3332 112.339 95.6146 121.243 99.9999C121.243 92.9999 131.91 75.6666 132.843 59.8852C143.577 55.8886 140.91 39.8973 133.541 39.8973C134.717 25.2386 111.243 17.6666 102.154 26.0793C92.91 14.9999 69.5767 20.6666 68.168 30.2786C52.1233 21.7139 41.5767 46.3332 56.6 55.8906C62.782 59.8239 77.2433 61.3206 98.1187 61.3206C101.27 61.3206 103.035 62.1032 102.154 65.9999C100.448 73.5506 104.409 78.3066 112.563 68.8059Z" fill="#1D0024"/></svg>'
    );
  });
});
