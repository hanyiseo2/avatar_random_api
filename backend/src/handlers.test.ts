import app from "./app";
import request from "supertest";

describe("GET /", () => {
  it("must response with a random image", async () => {
    const response = await request(app).get("/");
    expect(response.status).toBe(200);
  });

  it("must response with seed 'hanyi'", async () => {
    const response = await request(app).get("/?seed=hanyi");
    expect(response.status).toBe(200);
    expect(response.text).toEqual(
      '<svg width="200" height="200" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="200" height="200" fill="#FFC9B3"/><path d="M30 159.539C23.6533 172.443 20 202.205 20 202.205H180C180 202.205 176.345 172.44 170 159.539C163.655 146.637 126.6 134.671 126.6 134.671C119.458 149.333 80.2613 149.333 73.4193 134.667C73.4193 134.667 36.3467 146.634 30 159.539Z" fill="#1D0024"/><path d="M102.667 185.333C102.667 184.806 102.51 184.29 102.217 183.852C101.924 183.413 101.508 183.071 101.021 182.87C100.533 182.668 99.9971 182.615 99.4798 182.718C98.9625 182.821 98.4873 183.075 98.1144 183.448C97.7415 183.821 97.4875 184.296 97.3846 184.813C97.2817 185.33 97.3345 185.867 97.5363 186.354C97.7382 186.841 98.08 187.258 98.5185 187.551C98.957 187.844 99.4726 188 100 188C100.707 188 101.386 187.719 101.886 187.219C102.386 186.719 102.667 186.041 102.667 185.333ZM102.667 172C102.667 171.473 102.51 170.957 102.217 170.518C101.924 170.08 101.508 169.738 101.021 169.536C100.533 169.334 99.9971 169.282 99.4798 169.385C98.9625 169.487 98.4873 169.741 98.1144 170.114C97.7415 170.487 97.4875 170.962 97.3846 171.48C97.2817 171.997 97.3345 172.533 97.5363 173.02C97.7382 173.508 98.08 173.924 98.5185 174.217C98.957 174.51 99.4726 174.667 100 174.667C100.707 174.667 101.386 174.386 101.886 173.886C102.386 173.386 102.667 172.707 102.667 172ZM102.667 158.667C102.667 158.139 102.51 157.624 102.217 157.185C101.924 156.747 101.508 156.405 101.021 156.203C100.533 156.001 99.9971 155.948 99.4798 156.051C98.9625 156.154 98.4873 156.408 98.1144 156.781C97.7415 157.154 97.4875 157.629 97.3846 158.146C97.2817 158.664 97.3345 159.2 97.5363 159.687C97.7382 160.174 98.08 160.591 98.5185 160.884C98.957 161.177 99.4726 161.333 100 161.333C100.707 161.333 101.386 161.052 101.886 160.552C102.386 160.052 102.667 159.374 102.667 158.667V158.667Z" fill="white"/><path d="M79.3333 116V124C79.3333 134.667 64 139.333 64 139.333C64 139.333 81.6667 152.667 100 152.667C118.333 152.667 136 139.333 136 139.333C136 139.333 120.546 134.667 120.667 124C120.787 113.333 120.707 107.067 120.787 88.7919C130.342 76.4073 129.729 68.0953 124.504 62.2499C107 42.6666 59.3333 49.3333 59.3333 49.3333C59.3333 49.3333 54.8853 97.3286 65 111.333C69.3333 117.333 79.3333 116 79.3333 116Z" fill="#E6864E"/><path d="M112.653 70.1374C114.773 68.3167 117.349 67.0907 120.991 68.9827C129.623 73.4647 123.894 90.7567 114.233 90.4194C110.9 90.3034 112.428 96.9461 121.333 101.333C121.333 94.3334 132 77.0001 132.933 61.2187C143.667 57.2221 141 41.2307 133.631 41.2307C134.807 26.5701 111.333 18.9981 102.244 27.4107C93.0001 16.3314 69.6668 21.9981 68.2581 31.6101C52.2134 23.0454 41.6668 47.6647 56.6901 57.2221C62.8721 61.1554 77.3334 62.6521 98.2088 62.6521C108.226 62.6521 102.465 86.0987 99.3334 93.6667C95.3334 103.333 73.0001 104.667 66.0001 103.667C60.5334 102.886 57.6668 100.667 57.3334 99.3334C52.3334 112.667 58.6668 120.667 68.6668 120.667C85.6668 120.667 102.667 115.667 105.333 103.333C107.456 93.5181 107.339 77.6774 112.653 70.1374Z" fill="#1D0024"/></svg>'
    );
  });

  it("must response with seed 'claire'", async () => {
    const response = await request(app).get("/?seed=claire");
    expect(response.status).toBe(200);
    expect(response.text).toEqual(
      '<svg width="200" height="200" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="200" height="200" fill="#D0ACAC"/><path d="M67.2121 85.392C19.5854 46.3754 64.5355 10.6882 112.825 29.6951C117.991 31.7286 132.305 23.588 145.565 32.1642C154.119 37.6965 150.79 42.0321 154.121 46.3677C157.451 50.7034 170.292 50.4482 173.105 61.7062C174.771 68.376 170.161 75.3625 170.777 80.3827C171.394 85.4029 176.262 89.928 176.494 96.5554C176.595 99.3545 176.143 102.146 175.165 104.771C174.186 107.395 172.7 109.801 170.792 111.851C168.883 113.901 166.589 115.555 164.042 116.719C161.494 117.882 158.742 118.533 155.942 118.632C155.92 124.166 153.759 129.477 149.912 133.455C146.065 137.432 140.829 139.77 135.299 139.977C131.624 140.106 122.317 140.108 114.32 135.283C94.2798 123.198 98.7762 111.248 67.2121 85.392Z" fill="white"/><path d="M161.333 158.95C166.222 168.366 168.667 202.667 168.667 202.667H31.3333C31.3333 202.667 33.7779 168.366 38.6666 158.95C45.9999 144.826 99.9999 126.667 99.9999 126.667C99.9999 126.667 154 144.826 161.333 158.95Z" fill="#E6864E"/><path d="M100.022 138.65C104.84 138.432 116 136.072 116 130.973V126.667C117.223 126.667 120.723 129.555 122.524 132C129.641 141.667 121.747 150.333 115.308 150.333C107.184 150.333 101.8 143.545 100 140.28C98.2 143.547 92.816 150.333 84.692 150.333C78.2533 150.333 70.3587 141.667 77.476 132C79.2767 129.555 82.7773 126.667 84 126.667V130.973C84 136.072 95.4613 138.432 100.022 138.65Z" fill="white"/><path d="M97.3333 184C97.3333 183.473 97.4896 182.957 97.7827 182.518C98.0757 182.08 98.4922 181.738 98.9794 181.536C99.4667 181.335 100.003 181.282 100.52 181.385C101.037 181.487 101.513 181.741 101.886 182.114C102.258 182.487 102.512 182.962 102.615 183.48C102.718 183.997 102.665 184.533 102.464 185.021C102.262 185.508 101.92 185.924 101.481 186.217C101.043 186.51 100.527 186.667 99.9999 186.667C99.2927 186.667 98.6144 186.386 98.1143 185.886C97.6142 185.386 97.3333 184.707 97.3333 184ZM97.3333 170.667C97.3333 170.139 97.4896 169.624 97.7827 169.185C98.0757 168.747 98.4922 168.405 98.9794 168.203C99.4667 168.001 100.003 167.948 100.52 168.051C101.037 168.154 101.513 168.408 101.886 168.781C102.258 169.154 102.512 169.629 102.615 170.146C102.718 170.664 102.665 171.2 102.464 171.687C102.262 172.174 101.92 172.591 101.481 172.884C101.043 173.177 100.527 173.333 99.9999 173.333C99.2927 173.333 98.6144 173.052 98.1143 172.552C97.6142 172.052 97.3333 171.374 97.3333 170.667ZM97.3333 157.333C97.3333 156.806 97.4896 156.29 97.7827 155.852C98.0757 155.413 98.4922 155.072 98.9794 154.87C99.4667 154.668 100.003 154.615 100.52 154.718C101.037 154.821 101.513 155.075 101.886 155.448C102.258 155.821 102.512 156.296 102.615 156.813C102.718 157.33 102.665 157.867 102.464 158.354C102.262 158.841 101.92 159.258 101.481 159.551C101.043 159.844 100.527 160 99.9999 160C99.2927 160 98.6144 159.719 98.1143 159.219C97.6142 158.719 97.3333 158.041 97.3333 157.333V157.333Z" fill="#130027"/><path d="M116.001 136C111.112 144 88.8892 144 84.0006 136V122.667C84.0006 122.667 81.8252 122.733 80.3339 122.667C64.7399 122 59.5292 96.9153 61.9766 71.8253C63.7686 53.4507 79.3339 78.6667 104.667 61C103.667 80.3333 112.001 78.3333 115.667 76C132.334 68.3333 132.473 99.7613 116.001 97.3333V136Z" fill="#FFBB94"/></svg>'
    );
  });
});
